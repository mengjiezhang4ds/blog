"0","EM_estV2 <- function(Yt = tempY, Z1 = tempX, Z2 = tempX, missing = tempMissing) {"
"0","  Tz <- NROW(Z1)"
"0","  N <- NCOL(Z1)"
"0","  K1 <- if (length(dim(Z1)) > 2) dim(Z1)[3] else 1"
"0","  K2 <- if (length(dim(Z2)) > 2) dim(Z2)[3] else 1"
"0","  "
"0","  # set.seed(123)"
"0","  BT <- matrix(rnorm(Tz * (K1 + 1)), nrow = Tz)"
"0","  BT_fixT <- matrix(rnorm(Tz * (K1 + 1)), nrow = Tz)"
"0","  BN <- matrix(rnorm(N * ((N - 1) * K2)), nrow = N)"
"0","  "
"0","  list(BN = BN, BT = BT, BT_fixT = BT_fixT)"
"0","}"
"0",""
"0","squeezefun <- function(tmp) {"
"0","  dimres <- dim(tmp)"
"0","  filter <- which(dimres != 1)"
"0","  if (length(filter) == 2) {"
"0","    matrix(tmp, dimres[filter[1]], dimres[filter[2]])"
"0","  } else if (length(filter) == 1) {"
"0","    if (filter[1] == 2) {"
"0","      matrix(tmp, 1, dimres[filter[1]])"
"0","    } else {"
"0","      matrix(tmp, dimres[filter[1]], 1)"
"0","    }"
"0","  } else {"
"0","    tmp"
"0","  }"
"0","}"
